<div class="vscode-container">
  <!-- Title Bar -->
  <div class="titlebar">
    <div class="window-controls">
      <div class="window-dot red"></div>
      <div class="window-dot yellow"></div>
      <div class="window-dot green"></div>
    </div>
    <div class="search-bar">
      <span class="search-icon">🔍</span>
      <input type="text" placeholder="Protospace Checker" readonly>
    </div>
  </div>

  <!-- Main Container -->
  <div class="main-container">
    <!-- Activity Bar -->
    <div class="activity-bar">
      <div class="activity-icon active" id="files-icon">
        <span>📁</span>
      </div>
      <div class="activity-icon" id="settings-icon">
        <span>⚙</span>
      </div>
    </div>

    <!-- Sidebar -->
    <div class="sidebar">
      <div class="sidebar-resize-handle"></div>
      <div class="sidebar-header">
        エクスプローラー
      </div>
      <div class="sidebar-section">
        <div class="sidebar-section-title">
          <span class="chevron">▼</span>
          <span>CHECKER</span>
        </div>
        <div class="sidebar-item">
          <span class="file-icon">📄</span>
          <span>check_config.rb</span>
        </div>
        <div class="sidebar-item">
          <span class="file-icon">📄</span>
          <span>results.json</span>
        </div>
      </div>
      <div class="sidebar-section" data-screenshot-section="true">
        <div class="sidebar-section-title">
          <span class="chevron">▼</span>
          <span>SCREENSHOTS</span>
        </div>
      </div>
    </div>

    <!-- Editor Area -->
    <div class="editor-container">
      <div class="tab-bar">
        <div class="tab active">
          <span>📄</span>
          <span>checker.rb</span>
        </div>
      </div>
      <div class="editor-content">
        <h1>Protospace Checker</h1>
        <div class="subtitle">チェック対象のアプリURLを入力してください</div>

        <%= form_with url: checks_path, method: :post, local: true, data: { turbo: false }, style: "margin-top: 30px;" do |f| %>
          <div style="margin-bottom: 20px;">
            <label style="display: block; margin-bottom: 8px; color: #cccccc; font-size: 14px;">アプリケーションURL:</label>
            <%= text_field_tag :target_url, "",
              style: "width: 100%; max-width: 600px; padding: 8px 12px; background-color: #1e1e1e; border: 1px solid #3c3c3c; border-radius: 4px; color: #cccccc; font-size: 14px; outline: none;",
              placeholder: "例: http://localhost:3000",
              required: true,
              onfocus: "this.style.borderColor='#007acc'",
              onblur: "this.style.borderColor='#3c3c3c'" %>
          </div>
          <%= submit_tag "チェック開始",
            style: "padding: 10px 24px; background-color: #007acc; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; font-weight: bold;",
            onmouseover: "this.style.backgroundColor='#005a9e'",
            onmouseout: "this.style.backgroundColor='#007acc'" %>
        <% end %>
      </div>

      <!-- Bottom Panel (Terminal) -->
      <div class="panel">
        <div class="panel-resize-handle"></div>
        <div class="panel-header">
          <div class="panel-tab">問題</div>
          <div class="panel-tab">出力</div>
          <div class="panel-tab">デバッグ コンソール</div>
          <div class="panel-tab active">ターミナル</div>
          <div class="panel-tab">ポート</div>
          <div class="panel-controls">
            <span class="panel-control">+</span>
            <span class="panel-control">⌄</span>
            <span class="panel-control">×</span>
          </div>
        </div>
        <div class="panel-content">
          <%= form_with url: checks_path, method: :post, local: true, data: { turbo: false } do |f| %>
            <div class="terminal-input-line">
              <span class="terminal-prompt">$</span>
              <%= text_field_tag :target_url, "", class: "terminal-input", placeholder: "", required: true, autofocus: true %>
            </div>
            <%= submit_tag "送信", style: "display: none;" %>
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <!-- Status Bar -->
  <div class="status-bar">
    <div class="status-item">⎇ main</div>
    <div class="status-item">✓ 0</div>
    <div class="status-item">⚠ 0</div>
    <div class="status-bar-right">
      <div class="status-item">Ruby</div>
      <div class="status-item">UTF-8</div>
      <div class="status-item">LF</div>
    </div>
  </div>
</div>

<script>
  // サイドバーセクションの開閉機能
  document.addEventListener('DOMContentLoaded', function() {
    const sectionTitles = document.querySelectorAll('.sidebar-section-title');
    sectionTitles.forEach(title => {
      title.addEventListener('click', function() {
        const section = this.parentElement;
        const chevron = this.querySelector('.chevron');
        const items = Array.from(section.children).filter(child => child.classList.contains('sidebar-item'));

        // 開閉状態をトグル
        const isCollapsed = section.classList.toggle('collapsed');

        if (isCollapsed) {
          chevron.textContent = '▶';
          items.forEach(item => item.style.display = 'none');
        } else {
          chevron.textContent = '▼';
          items.forEach(item => item.style.display = 'flex');
        }
      });

      // カーソルをポインターに
      title.style.cursor = 'pointer';
    });

    // 設定画面コンテンツ
    const settingsContent = `
      <h1 style="color: #4ec9b0; font-size: 28px; margin-bottom: 20px;">⚙ Settings</h1>

      <div style="margin-bottom: 30px;">
        <h2 style="color: #569cd6; font-size: 20px; margin-bottom: 12px;">Checker Settings</h2>
        <div style="background-color: #1e1e1e; border: 1px solid #3c3c3c; border-radius: 4px; padding: 20px;">
          <div style="margin-bottom: 20px;">
            <label style="color: #cccccc; display: block; margin-bottom: 8px;">Default Timeout (seconds)</label>
            <input type="number" value="30" style="width: 100%; padding: 8px; background: #252526; border: 1px solid #3c3c3c; color: #cccccc; border-radius: 4px;" readonly>
            <p style="color: #858585; font-size: 12px; margin-top: 4px;">Maximum time to wait for elements to load</p>
          </div>

          <div style="margin-bottom: 20px;">
            <label style="color: #cccccc; display: block; margin-bottom: 8px;">Screenshot Quality</label>
            <select style="width: 100%; padding: 8px; background: #252526; border: 1px solid #3c3c3c; color: #cccccc; border-radius: 4px;" disabled>
              <option>High (Default)</option>
              <option>Medium</option>
              <option>Low</option>
            </select>
            <p style="color: #858585; font-size: 12px; margin-top: 4px;">Quality of captured screenshots</p>
          </div>

          <div>
            <label style="color: #cccccc; display: flex; align-items: center; cursor: not-allowed;">
              <input type="checkbox" checked disabled style="margin-right: 8px;">
              <span>Auto-scroll to latest log</span>
            </label>
            <p style="color: #858585; font-size: 12px; margin-top: 4px; margin-left: 24px;">Automatically scroll terminal to show latest output</p>
          </div>
        </div>
      </div>

      <div style="margin-bottom: 30px;">
        <h2 style="color: #569cd6; font-size: 20px; margin-bottom: 12px;">Display Settings</h2>
        <div style="background-color: #1e1e1e; border: 1px solid #3c3c3c; border-radius: 4px; padding: 20px;">
          <div style="margin-bottom: 20px;">
            <label style="color: #cccccc; display: block; margin-bottom: 8px;">Theme</label>
            <select style="width: 100%; padding: 8px; background: #252526; border: 1px solid #3c3c3c; color: #cccccc; border-radius: 4px;" disabled>
              <option>Dark (Default)</option>
              <option>Light</option>
            </select>
          </div>

          <div>
            <label style="color: #cccccc; display: flex; align-items: center; cursor: not-allowed;">
              <input type="checkbox" checked disabled style="margin-right: 8px;">
              <span>Show terminal by default</span>
            </label>
            <p style="color: #858585; font-size: 12px; margin-top: 4px; margin-left: 24px;">Display terminal panel when page loads</p>
          </div>
        </div>
      </div>

      <div style="margin-top: 40px; padding: 20px; background-color: #3c2a1e; border-left: 3px solid #c9a000; border-radius: 4px;">
        <p style="color: #dcdcaa; line-height: 1.8;">
          ⚠️ These settings are currently read-only and display default values. Configuration options may be added in future updates.
        </p>
      </div>
    `;

    // Activity Barのアイコンクリックイベント
    const filesIcon = document.getElementById('files-icon');
    const settingsIcon = document.getElementById('settings-icon');
    const sidebar = document.querySelector('.sidebar');
    const tabBar = document.querySelector('.tab-bar');
    const editorContent = document.querySelector('.editor-content');

    // 元のコンテンツを保存
    const originalTabContent = tabBar.innerHTML;
    const originalEditorContent = editorContent.innerHTML;

    if (filesIcon) {
      filesIcon.addEventListener('click', function() {
        // フォルダアイコンがアクティブに
        filesIcon.classList.add('active');
        settingsIcon.classList.remove('active');

        // サイドバーを表示
        sidebar.style.display = 'flex';

        // 元のコンテンツに戻す
        tabBar.innerHTML = originalTabContent;
        editorContent.innerHTML = originalEditorContent;
      });
    }

    if (settingsIcon) {
      settingsIcon.addEventListener('click', function() {
        // 設定アイコンがアクティブに
        settingsIcon.classList.add('active');
        filesIcon.classList.remove('active');

        // サイドバーを非表示
        sidebar.style.display = 'none';

        // タブを更新
        tabBar.innerHTML = `
          <div class="tab active">
            <span>⚙</span>
            <span>Settings</span>
          </div>
        `;

        // 設定画面を表示
        editorContent.innerHTML = settingsContent;
      });
    }
  });
</script>
